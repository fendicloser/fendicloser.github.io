<!DOCTYPE html><html lang="en-us"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1"><title>express-session保存用户登陆状态 | Longfu Sun</title><meta name="description"><meta name="generator" content="Longfu Sun"><meta name="author" content="Longfu Sun"><meta name="keywords" content="sjaak van den berg, svdb, bitcoin, crypto, payment, integration, bitcoins, wordpress, betaling, webshop, front end, design, ontwerp, developer"><meta name="HandheldFriendly" content="True"><meta name="MobileOptimized" content="320"><meta name="viewport" content="width=device-width,initial-scale=1.0,maximum-scale=1,user-scalable=0"><link rel="stylesheet" type="text/css" href="/styles/screen.css"><link rel="apple-touch-icon" sizes="57x57" href="/images/apple-touch-icon-57x57.png"><link rel="apple-touch-icon" sizes="60x60" href="/images/apple-touch-icon-60x60.png"><link rel="apple-touch-icon" sizes="72x72" href="/images/apple-touch-icon-72x72.png"><link rel="apple-touch-icon" sizes="76x76" href="/images/apple-touch-icon-76x76.png"><link rel="apple-touch-icon" sizes="114x114" href="/images/apple-touch-icon-114x114.png"><link rel="apple-touch-icon" sizes="120x120" href="/images/apple-touch-icon-120x120.png"><link rel="apple-touch-icon" sizes="144x144" href="/images/apple-touch-icon-144x144.png"><link rel="apple-touch-icon" sizes="152x152" href="/images/apple-touch-icon-152x152.png"><link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-180x180.png"><link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32.png"><link rel="icon" type="image/png" sizes="96x96" href="/images/favicon-96x96.png"><link rel="icon" type="image/png" sizes="160x160" href="/images/favicon-160x160.png"><link rel="icon" type="image/png" sizes="192x192" href="/images/favicon-192x192.png"><meta name="msapplication-TileColor" content="#121315"><meta name="msapplication-TileImage" content="/images/mstile-144x144.png"><link rel="alternate" type="application/atom+xml" title="Atom 0.3" href="atom.xml"></head><body itemscope itemtype="https://schema.org/WebPage"><header itemscope itemtype="https://schema.org/WPHeader"><a href="/"><img src="/images/svdb.png" alt="Longfu Sun" title="Longfu Sun"></a><h1><a href="/" alt="Longfu Sun" title="Longfu Sun" itemprop="headline">Longfu Sun</a></h1><p itemprop="description">Live a life you will remember</p><nav itemscope itemtype="https://schema.org/SiteNavigationElement"><ul><li itemprop="name"><a href="/" alt="Home" title="Home" itemprop="url">Home</a></li><li itemprop="name"><a href="/articles" alt="Articles" title="Articles" itemprop="url">Articles</a></li><li itemprop="name"><a href="/about" alt="About" title="About" itemprop="url">About</a></li></ul></nav><div class="space"></div></header><main itemscope itemtype="https://schema.org/Blog"><article class="full"><h1 itemprop="headline">express-session保存用户登陆状态</h1><span class="post-meta">Published on<time itemprop="datePublished" datetime="2019-04-08T11:50:58.000Z"> Monday, April 8th 2019 at 19:50</time><br>Last updated on<time itemprop="dateModified" datetime="2019-04-08T11:50:58.000Z"> Monday, April 8th 2019 at 20:32</time></span><p>对seesion和cookie的使用是web开发中非常重要的操作，在初学web开发时，程序员都会有这样的疑问，如何让自己的网站记住一个用户的登陆状态？ 登陆的信息应该存在前端还是后台？session和cookie有什么关系。这种疑问应该在学习完html/css/js dom操作/服务器搭建以及ajax后受到重视。<br>也就是说，想要弄清seesion和cookie你应该具备上述的基本知识。正如一位前辈所说，前端应该以全栈工程师的身份进行学习和思考。</p>
<p>本篇blog将解释如何用express-session存储用户登陆信息、在页面间传递；搭建最最基础的express全栈框架。<br>本blog想实现的效果是（截图怕说不明白，还是口述把）：在/user_login.html中输入用户名：”user”和密码”123”，以此模拟查找数据库的操作，如果服务器收到的信息正确，则跳转到welcome.html。在这个页面中可以渲染出用户名，并且有个”登出”按钮，点击后删除session中的数据。<br>文件的目录文件如下：<br><img src="/2019/04/08/express-session保存用户登陆状态/1.png" alt><br>非常的简单，对node感到陌生的同学也可以通过本片blog学习一下如何创建一个全栈项目，在此基础上加上数据库控制就是”完美了”。</p>
<p>首先是package.json：<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="string">"name"</span>: <span class="string">"tryajax2trysession"</span>,</span><br><span class="line">  <span class="string">"version"</span>: <span class="string">"1.0.0"</span>,</span><br><span class="line">  <span class="string">"description"</span>: <span class="string">""</span>,</span><br><span class="line">  <span class="string">"main"</span>: <span class="string">"index.js"</span>,</span><br><span class="line">  <span class="string">"scripts"</span>: &#123;</span><br><span class="line">    <span class="string">"start"</span>: <span class="string">"node ./app.js"</span>,</span><br><span class="line">    <span class="string">"test"</span>: <span class="string">"echo \"Error: no test specified\" &amp;&amp; exit 1"</span></span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="string">"author"</span>: <span class="string">""</span>,</span><br><span class="line">  <span class="string">"license"</span>: <span class="string">"ISC"</span>,</span><br><span class="line">  <span class="string">"dependencies"</span>: &#123;</span><br><span class="line">    <span class="string">"body-parser"</span>: <span class="string">"^1.18.3"</span>,</span><br><span class="line">    <span class="string">"express"</span>: <span class="string">"^4.16.4"</span>,</span><br><span class="line">    <span class="string">"express-session"</span>: <span class="string">"^1.15.6"</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>根据dependencies自行npm install一下。版本基本没什么问题。</p>
<h4 id="app-js文件，"><a href="#app-js文件，" class="headerlink" title="app.js文件，"></a>app.js文件，</h4><p>把session配置在这里，引入路由器和静态文件<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> express=<span class="built_in">require</span>(<span class="string">'express'</span>)</span><br><span class="line"><span class="keyword">var</span> session=<span class="built_in">require</span>(<span class="string">'express-session'</span>)</span><br><span class="line"><span class="keyword">var</span> userRouter=<span class="built_in">require</span>(<span class="string">'./router/users'</span>)</span><br><span class="line"><span class="keyword">var</span> app=express()</span><br><span class="line">app.listen(<span class="number">8080</span>)</span><br><span class="line"></span><br><span class="line">app.use(express.static(<span class="string">'public'</span>))</span><br><span class="line">app.use(express.static(<span class="string">'public/view'</span>))</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> idKey=<span class="string">'skey'</span></span><br><span class="line">app.use(session(&#123;</span><br><span class="line">    name:idKey,</span><br><span class="line">    secret:<span class="string">'fendicloser'</span>,</span><br><span class="line">    resave:<span class="literal">true</span>,<span class="comment">//是否自动保存未自动保存初始化的对话，</span></span><br><span class="line">    saveUninitialized:<span class="literal">true</span>,</span><br><span class="line">    cookie:&#123;</span><br><span class="line">        maxAge:<span class="number">30</span>*<span class="number">60</span>*<span class="number">1000</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;))</span><br><span class="line">app.use(<span class="string">'/user'</span>,userRouter)</span><br></pre></td></tr></table></figure></p>
<p>cookie中设置过期时间，以毫秒为单位，这里根据大部分网站的习惯设置为30分钟。<br>resave和saveUninitialized是需要设置的，否则使用过程中可能出现限制，</p>
<h6 id="resave："><a href="#resave：" class="headerlink" title="resave："></a>resave：</h6><p>是否允许session重新设置</p>
<h6 id="saveUninitialized："><a href="#saveUninitialized：" class="headerlink" title="saveUninitialized："></a>saveUninitialized：</h6><p>是否允许session在使用过程中被修改。</p>
<h4 id="路由器-router-users-js"><a href="#路由器-router-users-js" class="headerlink" title="路由器./router/users.js"></a>路由器./router/users.js</h4><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> express=<span class="built_in">require</span>(<span class="string">'express'</span>)</span><br><span class="line"><span class="keyword">var</span> router=express.Router()</span><br><span class="line"><span class="keyword">var</span> bodyParser=<span class="built_in">require</span>(<span class="string">'body-parser'</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">router.use(bodyParser.urlencoded(&#123;<span class="attr">extended</span>:<span class="literal">false</span>&#125;))</span><br><span class="line">router.post(<span class="string">'/login'</span>,<span class="function"><span class="keyword">function</span> (<span class="params">req,res</span>) </span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(req.body)</span><br><span class="line">    <span class="keyword">if</span>(req.body.userNickName==<span class="string">'user'</span>&amp;&amp;req.body.userPassowrd==<span class="string">'123'</span>)&#123;</span><br><span class="line">        req.session.userNickName=req.body.userNickName</span><br><span class="line">        res.json([&#123;<span class="string">'code'</span>:<span class="string">'200'</span>,<span class="string">'text'</span>:<span class="string">'login success'</span>&#125;])</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">        res.json([&#123;<span class="string">'code'</span>:<span class="string">'201'</span>,<span class="string">'text'</span>:<span class="string">'login failed'</span>&#125;])</span><br><span class="line">&#125;)</span><br><span class="line">router.get(<span class="string">'/welcome'</span>,<span class="function"><span class="keyword">function</span>(<span class="params">req,res</span>)</span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span>(req.session.userNickName)&#123;</span><br><span class="line">        res.send([&#123;<span class="string">'code'</span>:<span class="string">'200'</span>,<span class="string">'userNickName'</span>:req.session.userNickName&#125;])</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        res.send([&#123;<span class="string">'code'</span>:<span class="string">'201'</span>,<span class="string">'userNickName'</span>:<span class="string">'not login yet'</span>&#125;])</span><br><span class="line">    &#125;</span><br><span class="line">&#125;)</span><br><span class="line">router.post(<span class="string">'/logout'</span>,<span class="function"><span class="keyword">function</span>(<span class="params">req,res</span>)</span>&#123;</span><br><span class="line">    req.session.userNickName=<span class="literal">null</span></span><br><span class="line">    res.json([&#123;<span class="string">'code'</span>:<span class="string">'200'</span>,<span class="string">'text'</span>:<span class="string">'logout success'</span>&#125;])</span><br><span class="line">&#125;)</span><br><span class="line"><span class="built_in">module</span>.exports=router</span><br></pre></td></tr></table></figure>
<p>一个三个接口，登陆一个，跳转是访问一个，登出一个，最最关键的一句话是req.session.userNickName=req.body.userNickName。</p>
<p>在/login中设置了req.session,userNickName但是在此之后任何一个路由中console.log（req.session）你都看不到userNickName的相关数据。当初使用以为访问不到，耽误了很长时间，知道真相的我眼泪流下来<br>。<br>登出时，<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">req.session.userNickName=<span class="literal">null</span></span><br></pre></td></tr></table></figure></p>
<h4 id="登陆页面public-view-user-login-html"><a href="#登陆页面public-view-user-login-html" class="headerlink" title="登陆页面public/view/user_login.html"></a>登陆页面public/view/user_login.html</h4><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><span class="line">&lt;!DOCTYPE html&gt;</span><br><span class="line">&lt;html lang=<span class="string">"en"</span>&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">    &lt;meta charset=<span class="string">"UTF-8"</span>&gt;</span><br><span class="line">    &lt;title&gt;Title&lt;<span class="regexp">/title&gt;</span></span><br><span class="line"><span class="regexp">    &lt;script src="http:/</span><span class="regexp">/libs.baidu.com/</span>jquery/<span class="number">2.1</span><span class="number">.4</span>/jquery.min.js<span class="string">"&gt;&lt;/script&gt;</span></span><br><span class="line"><span class="string">    &lt;script type="</span>text/javascript<span class="string">"&gt;</span></span><br><span class="line"><span class="string">        function sendAjaxQuery(url, data) &#123;</span></span><br><span class="line"><span class="string">            $.ajax(&#123;</span></span><br><span class="line"><span class="string">                url: url ,</span></span><br><span class="line"><span class="string">                data: data,</span></span><br><span class="line"><span class="string">                dataType: 'json',</span></span><br><span class="line"><span class="string">                type: 'POST',</span></span><br><span class="line"><span class="string">                xhrFields: &#123;</span></span><br><span class="line"><span class="string">                    withCredentials: true</span></span><br><span class="line"><span class="string">                &#125;,</span></span><br><span class="line"><span class="string">                success: function (dataR) &#123;</span></span><br><span class="line"><span class="string">                    var ret = dataR;</span></span><br><span class="line"><span class="string">                    if(ret[0].code==200)&#123;</span></span><br><span class="line"><span class="string">                        window.location.href='/welcome.html'</span></span><br><span class="line"><span class="string">                    &#125;else&#123;</span></span><br><span class="line"><span class="string">                        alert('登陆失败，请重试')</span></span><br><span class="line"><span class="string">                    &#125;</span></span><br><span class="line"><span class="string">                &#125;,</span></span><br><span class="line"><span class="string">                error: function (xhr, status, error) &#123;</span></span><br><span class="line"><span class="string">                    alert('Error: ' + error.message);</span></span><br><span class="line"><span class="string">                &#125;</span></span><br><span class="line"><span class="string">            &#125;);</span></span><br><span class="line"><span class="string">        &#125;</span></span><br><span class="line"><span class="string">        function onSubmit() &#123;</span></span><br><span class="line"><span class="string">            var formArray= $("</span>form<span class="string">").serializeArray();</span></span><br><span class="line"><span class="string">            var data=&#123;&#125;;</span></span><br><span class="line"><span class="string">            for (var i=0;i&lt;formArray.length;i++)&#123;</span></span><br><span class="line"><span class="string">                data[formArray[i].name]= formArray[i].value;</span></span><br><span class="line"><span class="string">            &#125;</span></span><br><span class="line"><span class="string">            sendAjaxQuery('/user/login', $.param(data));</span></span><br><span class="line"><span class="string">            event.preventDefault();</span></span><br><span class="line"><span class="string">        &#125;</span></span><br><span class="line"><span class="string">    &lt;/script&gt;</span></span><br><span class="line"><span class="string">&lt;/head&gt;</span></span><br><span class="line"><span class="string">&lt;body&gt;</span></span><br><span class="line"><span class="string">&lt;form id=“xForm"</span> onsubmit=<span class="string">"onSubmit()"</span>&gt;</span><br><span class="line">    &lt;p&gt;</span><br><span class="line">        &lt;input type=<span class="string">"text"</span> name=<span class="string">"userNickName"</span> placeholder=<span class="string">"userNickName"</span>/&gt;</span><br><span class="line">    &lt;<span class="regexp">/p&gt;</span></span><br><span class="line"><span class="regexp">    &lt;p&gt;</span></span><br><span class="line"><span class="regexp">        &lt;input type="text" name ="userPassowrd" placeholder="userPassowrd"/</span>&gt;</span><br><span class="line">    &lt;<span class="regexp">/p&gt;</span></span><br><span class="line"><span class="regexp">    &lt;p&gt;</span></span><br><span class="line"><span class="regexp">        &lt;input type="submit" name="g" value="Submit" id="g"&gt;</span></span><br><span class="line"><span class="regexp">    &lt;/</span>p&gt;</span><br><span class="line">&lt;<span class="regexp">/form&gt;</span></span><br><span class="line"><span class="regexp">&lt;/</span>body&gt;</span><br><span class="line">&lt;<span class="regexp">/html&gt;</span></span><br></pre></td></tr></table></figure>
<p>ajax里的<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">xhrFields: &#123;</span><br><span class="line">     withCredentials: <span class="literal">true</span></span><br><span class="line">&#125;,</span><br></pre></td></tr></table></figure></p>
<p> 是设置凭证用的，当跨域想带上cookie的时候，需要设置认证。</p>
<h4 id="目标页面public-view-welcome-html"><a href="#目标页面public-view-welcome-html" class="headerlink" title="目标页面public/view/welcome.html"></a>目标页面public/view/welcome.html</h4><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br></pre></td><td class="code"><pre><span class="line">&lt;!DOCTYPE html&gt;</span><br><span class="line">&lt;html lang=<span class="string">"en"</span>&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">    &lt;meta charset=<span class="string">"UTF-8"</span>&gt;</span><br><span class="line">    &lt;script src=<span class="string">"http://libs.baidu.com/jquery/2.1.4/jquery.min.js"</span>&gt;<span class="xml"><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span></span><br><span class="line">    &lt;title&gt;Title&lt;<span class="regexp">/title&gt;</span></span><br><span class="line"><span class="regexp">    &lt;script type="text/</span>javascript<span class="string">"&gt;</span></span><br><span class="line"><span class="string">        $(document).ready(function()&#123;</span></span><br><span class="line"><span class="string">            $.ajax(&#123;</span></span><br><span class="line"><span class="string">                url:'/user/welcome',</span></span><br><span class="line"><span class="string">                data: '',</span></span><br><span class="line"><span class="string">                type: 'GET',</span></span><br><span class="line"><span class="string">                dataType: 'json',</span></span><br><span class="line"><span class="string">                xhrFields: &#123;</span></span><br><span class="line"><span class="string">                    withCredentials: true</span></span><br><span class="line"><span class="string">                &#125;,</span></span><br><span class="line"><span class="string">                success: function (dataR) &#123;</span></span><br><span class="line"><span class="string">                    if(dataR[0].code=='200')&#123;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">                        $('#userArea').html('! '+dataR[0].userNickName)</span></span><br><span class="line"><span class="string">                    &#125;</span></span><br><span class="line"><span class="string">                    else&#123;</span></span><br><span class="line"><span class="string">                        $('#userArea').html(',  login please')</span></span><br><span class="line"><span class="string">                    &#125;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">                &#125;,</span></span><br><span class="line"><span class="string">                error: function (xhr, status, error) &#123;</span></span><br><span class="line"><span class="string">                    alert('Error: ' + error.message);</span></span><br><span class="line"><span class="string">                &#125;,</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">            &#125;)</span></span><br><span class="line"><span class="string">            $('#logout').click(function () &#123;</span></span><br><span class="line"><span class="string">                $.ajax(&#123;</span></span><br><span class="line"><span class="string">                    url:'/user/logout',</span></span><br><span class="line"><span class="string">                    data:'',</span></span><br><span class="line"><span class="string">                    type:'POST',</span></span><br><span class="line"><span class="string">                    dataType: 'json',</span></span><br><span class="line"><span class="string">                    xhrFields: &#123;</span></span><br><span class="line"><span class="string">                        withCredentials:true</span></span><br><span class="line"><span class="string">                    &#125;,</span></span><br><span class="line"><span class="string">                    success:function (dataR) &#123;</span></span><br><span class="line"><span class="string">                        console.log('登出成功')</span></span><br><span class="line"><span class="string">                        window.location.href='/welcome.html'</span></span><br><span class="line"><span class="string">                    &#125;,</span></span><br><span class="line"><span class="string">                    error:function(xhr,status,error)&#123;</span></span><br><span class="line"><span class="string">                        alert('Error: '+error.message)</span></span><br><span class="line"><span class="string">                    &#125;</span></span><br><span class="line"><span class="string">                &#125;)</span></span><br><span class="line"><span class="string">            &#125;)</span></span><br><span class="line"><span class="string">        &#125;)</span></span><br><span class="line"><span class="string">    &lt;/script&gt;</span></span><br><span class="line"><span class="string">&lt;/head&gt;</span></span><br><span class="line"><span class="string">&lt;body&gt;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">&lt;div id="</span>welcome<span class="string">"&gt;</span></span><br><span class="line"><span class="string">    welcome&lt;span id="</span>userArea<span class="string">"&gt;&lt;/span&gt;</span></span><br><span class="line"><span class="string">&lt;/div&gt;</span></span><br><span class="line"><span class="string">&lt;button id="</span>logout<span class="string">"&gt;登出&lt;/button&gt;</span></span><br><span class="line"><span class="string">&lt;/body&gt;</span></span><br><span class="line"><span class="string">&lt;/html&gt;</span></span><br></pre></td></tr></table></figure>
<p>上述就是全部过程了，非常简单。别写的过程自然不是一个个文件加从上到下顺着敲出来的，希望同学在复制粘贴成功运行后自己读读程序理解一下。</p>
<p>最后的最后多说两点：</p>
<h6 id="1自己需要弄明白的下一个问题是：如何把一个reactJS项目修改成一个react-express项目：代理？修改react-script的源码？用github上已有的脚手架？"><a href="#1自己需要弄明白的下一个问题是：如何把一个reactJS项目修改成一个react-express项目：代理？修改react-script的源码？用github上已有的脚手架？" class="headerlink" title="1自己需要弄明白的下一个问题是：如何把一个reactJS项目修改成一个react-express项目：代理？修改react-script的源码？用github上已有的脚手架？"></a>1自己需要弄明白的下一个问题是：如何把一个reactJS项目修改成一个react-express项目：代理？修改react-script的源码？用github上已有的脚手架？</h6><h6 id="2jquery虽然正在被人诟病，但是它的ajax还是比原生好太多了，res-json？-res-render？-res-send？"><a href="#2jquery虽然正在被人诟病，但是它的ajax还是比原生好太多了，res-json？-res-render？-res-send？" class="headerlink" title="2jquery虽然正在被人诟病，但是它的ajax还是比原生好太多了，res.json？ res.render？ res.send？"></a>2jquery虽然正在被人诟病，但是它的ajax还是比原生好太多了，res.json？ res.render？ res.send？</h6></article></main></body></html>